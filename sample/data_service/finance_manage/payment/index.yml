service:
  # 查询流水
  - key: "payment"
    module: 'mysql'# 执行mysql 查询
    params:
      pagination: # 查询分页
        default: true
        type: bool
      page:
        default: 1
        type: int
      size:
        default: 20
        type: int
      start_row:
        exp: '({page}-1)*{size}'
        default: 0
      start_time:
        format: '{start} 00:00:00'
        default: ''
      end_time:
        format: '{end} 23:59:59'
        default: ''
      start_date:
        template: "{{start|replace('-','')}}"
        default: ''
      end_date:
        template: "{{end|replace('-','')}}"
        default: ''
      search:
        template: '{%if search and search != "" %} %{{search}}% {%endif%}'
        default: ''
    log: true
    sql_file: 'payment.sql'
    count_params:
      pagination: # 总数不分页
        default: false
        type: bool
    count_sql: 'count_payment.sql'
    result_parse: "excel"
    data_type: 'file'
    excel_out_path: './attendance_out/payment_excel.xls'
    file_name: '报销打款.xls'
    excel:
      0:
        title_row: 0
        title_style: 'alignment:vert center;font:color white ,height 240;pattern: pattern solid, fore_colour light_blue;'
        name_row: 1
        name_style: 'font:color white ;pattern: pattern solid, fore_colour ocean_blue'
        start_row: 2
        frozen_col: 1
        title: 报销打款
        data: result
        fields:
          - name: 流程号
            value: wf_no
            width: 120
          - name: 状态
            value: flow_status_text
          - name: 金额
            value: money
          - name: 姓名
            value: username
          - name: 部门
            value: hrm_department_name
          - name: 项目
            value: project_name
            width: 200
          - name: 审批结束时间
            value: finish_time
            width: 140
          - name: 打款时间
            value: cost_time
          - name: 银行卡号
            value: pay_card_num
            width: 180
          - name: 流水号
            value: sno
            width: 220

